---
layout: post
title: Execution Context
author: vgihan
description: study JavaScript's Execution Context
tags: [JavaScript, execution-context, scope]
categories: [JavaScript]
extensions:
  preset: gfm
---

자바스크립트의 동작 원리를 담고 있는 자바스크립트의 핵심 원리. 실행 가능한 코드가 실행되기 위해 필요한 환경이다.

### 실행 컨텍스트의 생성

실행 컨텍스트는 프로그램이 실행될 때, 함수가 호출될 때 생성되며 콜스택이라고 하는 후입선출 구조에 push, pop 되며 실행 가능한 자바스크립트 코드의 실행이 일어난다.

**전역 실행 컨텍스트**

프로그램이 실행되면, 전역 실행 컨텍스트가 생성되고 콜스택에 쌓인다. 현재 실행하고 있는 코드인 컨트롤이 전역 실행 컨텍스트로 이동하게 된다.

**함수 실행 컨텍스트**

프로그램이 실행되고, 코드가 실행될 때 함수의 호출이 일어나면 콜스택에 함수 실행 컨텍스트가 쌓이고 컨트롤이 함수 실행 컨텍스트로 이동하게 된다.

### 실행 컨텍스트의 구조

앞서 실행 컨텍스트는 자바스크립트의 동작 원리를 담고 있는 자바스크립트의 핵심 원리라고 소개했다. 실행 컨텍스트는 3가지의 객체를 가지고 있는데, Variable Object, Scope Chain, this 가 바로 그 세 가지 객체이다.

- **Variable Object**

  - 전역 실행 컨텍스트의 경우, 전역 변수, 전역에서 선언된 함수를 객체화하여 담고 있다. 이를 Global Object 라고 한다.
  - 함수 실행 컨텍스트의 경우, 지역 변수, 함수 내부에서 선언된 함수를 객체화하여 담고 있다. 이를 Activation Object 라고 한다.
  - 컨트롤을 가지고 있는 실행 컨텍스트에서 코드를 순서대로 실행할 때, 변수를 가져오는 데 있어서 해당 실행 컨텍스트의 VO를 참조함으로써 변수를 사용할 수 있다.
  - VO에는 변수 뿐만 아니라 해당 환경에서 선언된 함수도 역시 저장되어 있기 때문에, 내부 함수의 호출이 일어났을 때도 VO를 참조하여 호출할 수 있다.
  - 함수 프로퍼티의 경우, [[Scopes]] 라는 객체를 참조하여 자신이 실행되는 환경의 스코프 체인을 참조할 수 있다. 그렇기 때문에 함수가 종료된 이후에도 [[Scope]] 를 이용하여 환경에 존재하는 함수나 변수를 참조할 수 있는데, 이것이 바로 클로저이다.

- **Scope Chain**
  - 실행 컨텍스트의 환경에서 선언된 함수나 변수 뿐만 아니라, 상위 컨텍스트의 함수나 변수를 참조할 수 있도록 Scope Chain을 통해 접근할 수 있도록 한다.
  - Scope Chain은 상위 컨텍스트의 참조를 순서대로 가지고 있기 때문에, 만약 함수나 변수의 참조가 일어나서 VO에서 해당 함수나 변수를 찾으려 했지만 찾지 못했을 때, 스코프 체인을 통해 상위 컨텍스트의 VO를 참조하여 해당 함수나 변수가 존재하는 지 찾는다.
  - 이렇게 전역 컨텍스트의 VO까지 거슬러 올라가서도 찾지 못했을 경우 undefined를 반환하게 된다.
- **this**
  - 객체를 가리키고 있는데, 어떤 객체를 가리킬 지는 함수 호출 패턴에 의해 결정된다.
  - 일반 함수일 경우 전역 객체를, 객체의 메서드일 경우 해당 객체를, 생성자 함수일 경우 마지막에 리턴하는 빈 객체를 가리킨다.
